{"version":3,"sources":["app/initialize.js","app/map_util.js","app/models/polygon.js","app/models/territory.js","app/views/map_view.js","app/views/search_view.js","app/views/territory_view.js"],"names":["document","addEventListener","window","searchView","SearchView","territoryView","TerritoryView","mapView","MapView","$","keydown","evt","which","cmdPressed","keyup","gmapifyPoints","points","point","google","maps","LatLng","gmapifyPolygons","polygons","poly","c","gon","i","innerCoords","len","outerCoords","purgeLonePoints","coords","push","length","Polygon","territory","originalCoords","accumulatedLatDiff","accumulatedLngDiff","e","startingLat","latLng","lat","startingLng","lng","gmapPolygon","getPaths","getArray","map","j","movePolygons","createGmapPolygon","event","addListener","dragStart","bind","dragEnd","clearInstanceListeners","setMap","removeFromMap","addToMap","bounds","LatLngBounds","forEach","p","extend","getCenter","paths","strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","draggable","geodesic","latDiff","lngDiff","move","Territory","attrs","Object","assign","id","getId","type","abbrev","terse","join","reset","remove","polygon","name","state","toUpperCase","country","root","url","getURL","getJSON","success","resp","addTerritory","error","err","allTerritories","t","territories","setCenter","zoom","setZoom","addPolygons","ele","dropdownMenu","find","input","on","onInput","onKeydown","onFocus","clickDropdownItem","places","countries","filter","states","cities","click","target","closest","removeClass","classList","add","val","setTimeout","closeDropdown","findById","getAttribute","fetchPoints","addItem","currentTarget","addClass","value","openDropdown","dir","active","children","index","last","first","item","moveSelection","goDown","goUp","hitEnter","hitEsc","matches","findMatches","innerHTML","renderDropdownHtml","html","friendlyName","badgeClass","query","RegExp","replace","some","thing","things","test","territoryDiv","clickTerritory","preventDefault","attr","hasClass","resetTerritory","gotoTerritory","dropdown","removeTerritory","renderTerritory","append"],"mappings":"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","file":"public/app.js","sourcesContent":["import Territory from 'models/territory.js';\nimport SearchView from 'views/search_view.js';\nimport TerritoryView from 'views/territory_view.js';\nimport MapView from 'views/map_view.js';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  // do your setup here\n  // console.log('Initialized app');\n\n  window.searchView = new SearchView;\n  window.territoryView = new TerritoryView;\n  window.mapView = new MapView;\n});\n\n$(window).keydown(function(evt) {\n  if (evt.which == 91) { // cmd\n    window.cmdPressed = true;\n  }\n}).keyup(function(evt) {\n  if (evt.which == 91) { // cmd\n    window.cmdPressed = false;\n  }\n});\n","import reject from 'lodash/reject';\nimport map from 'lodash/map';\n\nvar gmapifyPoints = function(points) {\n  return map(points, function(point) {\n    return new google.maps.LatLng(point[1], point[0]);\n  });\n};\n\nexport const gmapifyPolygons = function(polygons) {\n  return map(polygons, function(poly) {\n    var c, gon, i, innerCoords, len, outerCoords;\n    gon = [];\n    outerCoords = gmapifyPoints(purgeLonePoints(poly.outerCoords));\n    innerCoords = map(poly.innerCoords, function(coords) {\n      return gmapifyPoints(purgeLonePoints(coords));\n    });\n    gon.push(outerCoords);\n    for (i = 0, len = innerCoords.length; i < len; i++) {\n      c = innerCoords[i];\n      gon.push(c);\n    }\n    return gon;\n  });\n};\n\nvar purgeLonePoints = function(coords) {\n  return reject(coords, function(point) {\n    return point.length < 2;\n  });\n};\n","import map from 'lodash/map';\nimport reject from 'lodash/reject';\n\nclass Polygon {\n  constructor(coords, territory) {\n    this.territory = territory;\n    this.originalCoords = this.coords = coords;\n    this.accumulatedLatDiff = 0\n    this.accumulatedLngDiff = 0\n  }\n\n  dragStart(e) {\n    this.startingLat = e.latLng.lat()\n    this.startingLng = e.latLng.lng()\n  }\n\n  dragEnd(e) {\n    this.accumulatedLatDiff += (this.startingLat - e.latLng.lat())\n    this.accumulatedLngDiff += (this.startingLng - e.latLng.lng())\n\n    this.coords = this.gmapPolygon.getPaths().getArray().map(c => c.getArray().map(j => j))\n\n    if (window.cmdPressed) {\n      this.movePolygons(this.accumulatedLatDiff, this.accumulatedLngDiff);\n    }\n  }\n\n  addToMap() {\n    this.createGmapPolygon();\n\n    google.maps.event.addListener(this.gmapPolygon, 'dragstart', this.dragStart.bind(this));\n    google.maps.event.addListener(this.gmapPolygon, 'dragend', this.dragEnd.bind(this));\n  }\n\n  removeFromMap() {\n    google.maps.event.clearInstanceListeners(this.gmapPolygon);\n    this.gmapPolygon.setMap(null);\n  }\n\n  reset() {\n    this.accumulatedLatDiff = 0\n    this.accumulatedLngDiff = 0\n    this.coords = this.originalCoords\n    this.removeFromMap()\n    this.addToMap()\n  }\n\n  remove() {\n    this.removeFromMap();\n    //this.territory.polygons = reject(this.territory.polygons, p => p === this);\n  }\n\n  getCenter() {\n    let bounds = new google.maps.LatLngBounds()\n    let points = this.originalCoords[0]\n\n    points.forEach((p) => {\n      bounds.extend(p)\n    })\n\n    return bounds.getCenter()\n  }\n\n  createGmapPolygon() {\n    this.gmapPolygon = new google.maps.Polygon({\n      map: window.map,\n      paths: this.coords,\n      strokeColor: \"#FF0000\",\n      strokeOpacity: 0.8,\n      strokeWeight: 1,\n      fillColor: \"#FF0000\",\n      fillOpacity: 0.35,\n      draggable: true,\n      geodesic: true\n    })\n  }\n\n  move(latDiff, lngDiff) {\n    this.removeFromMap()\n\n    this.coords = map(this.originalCoords, (coords) => {\n      return map(coords, (c) => {\n        return new google.maps.LatLng(c.lat() - latDiff, c.lng() - lngDiff)\n      });\n    })\n\n    this.addToMap();\n  }\n\n  movePolygons(latDiff, lngDiff) {\n    this.territory.polygons.forEach((p) => {\n      if (p === this) return\n\n      p.move(latDiff, lngDiff)\n    })\n  }\n}\n\nexport default Polygon;\n","import find from 'lodash/find';\nimport map from 'lodash/map';\nimport Polygon from 'models/polygon.js';\n\nimport {gmapifyPolygons} from './../map_util.js';\n\nclass Territory {\n  constructor(attrs) {\n    this.polygons = [];\n\n    Object.assign(this, attrs);\n    this.id = this.getId()\n  }\n\n  getId() {\n    return [this.type, this.abbrev || this.terse].join('-')\n  }\n\n  reset() {\n    this.polygons.forEach(p => p.reset())\n  }\n\n  remove() {\n    this.polygons.forEach(p => p.remove())\n  }\n\n  addPolygon(polygon) {\n    this.polygons.push(polygon)\n  }\n\n  friendlyName() {\n    let name = this.name;\n\n    if (this.type == 'city') {\n      name = name + ` (${this.state.toUpperCase()})`\n    } else if (this.type == 'state') {\n      name = name + ` (${this.country.toUpperCase()})`\n    }\n\n    return name;\n  }\n\n  badgeClass() {\n    switch(this.type) {\n      case 'city': return 'info'\n      case 'state': return 'light'\n      case 'country': return 'dark'\n    }\n  }\n\n  static findById(id) {\n    return find(window.allTerritories, t => t.id == id)\n  }\n\n  getURL() {\n    const root = 'https://s3-us-west-2.amazonaws.com/yodap'\n    var url;\n\n    if (this.type == 'country') {\n      url = `${root}/countries/${this.abbrev}.json`\n    } else if (this.type == 'state') {\n      url = `${root}/states/${this.abbrev}.json`\n    } else if (this.type == 'city') {\n      url = `${root}/cities/${this.country}/${this.state}/${this.terse}.json`\n    }\n\n    return url;\n  }\n\n  getCenter() {\n    let bounds = new google.maps.LatLngBounds()\n    let polygon = this.polygons[0];\n    return polygon.getCenter();\n  }\n\n  addPolygons() {\n    this.polygons.forEach(p => p.addToMap())\n  }\n\n  fetchPoints() {\n    let url = this.getURL();\n\n    $.getJSON({\n      url: url,\n      success: (resp) => {\n        let coords = gmapifyPolygons(resp.polygons);\n        let polygons = map(coords, c => new Polygon(c, this))\n        this.polygons = polygons;\n        window.mapView.addTerritory(this);\n      },\n      error: (err) => {\n      }\n    });\n  }\n}\n\nexport default Territory;\n","import Polygon from 'models/polygon.js';\n\nclass MapView {\n  constructor() {\n    this.territories = [];\n  }\n\n  resetTerritory(t) {\n    t.reset();\n  }\n\n  gotoTerritory(t) {\n    window.map.setCenter(t.getCenter())\n\n    var zoom;\n    switch (t.type) {\n      case 'city':\n        zoom = 10;\n        break;\n      case 'state':\n        zoom = 5;\n        break;\n      case 'country':\n        zoom = 4;\n        break;\n    }\n\n    window.map.setZoom(zoom)\n  }\n\n  removeTerritory(t) {\n    t.remove()\n  }\n\n  addTerritory(t) {\n    t.addPolygons()\n  }\n}\n\nexport default MapView;\n","import Territory from '../models/territory.js';\nimport flatten from 'lodash/flatten';\n\n// import flatten from '../../node_modules/lodash/flatten.js';\n// import map from '../../node_modules/lodash/map.js';\n\nclass SearchView {\n  constructor() {\n    this.ele = $('#search-hold');\n    this.dropdownMenu = this.ele.find('.dropdown-menu');\n\n    let input = $('#search-input');\n    input.on('input', this.onInput.bind(this));\n    input.on('keydown', this.onKeydown.bind(this));\n    input.on('focus', this.onFocus.bind(this));\n    this.dropdownMenu.on('click', 'a.dropdown-item', this.clickDropdownItem.bind(this))\n\n    $.getJSON({\n      url: 'https://s3-us-west-2.amazonaws.com/yodap/places.json.gz',\n      success: function(places) {\n        window.countries = places.filter(p => p.type == 'country').map(p => new Territory(p));\n        window.states = places.filter(p => p.type == 'state').map(p => new Territory(p));\n        window.cities = places.filter(p => p.type == 'city').map(p => new Territory(p));\n        window.allTerritories = flatten([countries, states, cities]);\n      }.bind(this)\n    })\n\n    $(document).click((event) => {\n      if(!$(event.target).closest('#search-dropdown-hold').length) {\n        this.dropdownMenu.removeClass('show');\n      }\n    });\n  }\n\n  addItem(ele) {\n    ele.classList.add('active')\n    $('#search-input').val('')\n    setTimeout(() => this.closeDropdown(), 5)\n\n    let t = Territory.findById(ele.getAttribute('data-id'))\n    t.fetchPoints();\n    window.territoryView.addTerritory(t)\n  }\n\n  clickDropdownItem(e) {\n    this.dropdownMenu.find('a.active').removeClass('active')\n    this.addItem(e.currentTarget)\n  }\n\n  openDropdown() {\n    this.dropdownMenu.addClass('show')\n  }\n\n  closeDropdown() {\n    this.dropdownMenu.removeClass('show')\n  }\n\n  onFocus(e) {\n    if (e.currentTarget.value.length) {\n      this.openDropdown()\n    }\n  }\n\n  moveSelection(dir) {\n    let active = this.dropdownMenu.find('.active')[0];\n    let children = this.dropdownMenu.children();\n\n    let index = active ? children.index(active) : -1;\n\n    let ele = children[index + dir];\n\n    if (!ele) {\n      ele = dir == -1 ? children.last()[0] : children.first()[0]\n    }\n\n    children.removeClass('active')\n\n    if (ele) {\n      ele.classList.add('active')\n    }\n  }\n\n  hitEnter() {\n    let item;\n    if (item = this.dropdownMenu.find('.active')[0]) {\n      this.addItem(item);\n    }\n  }\n\n  hitEsc() {\n    this.closeDropdown()\n  }\n\n  goUp() { this.moveSelection(-1) }\n  goDown() { this.moveSelection(1) }\n\n  onKeydown(e) {\n    if (e.which == 40) {\n      this.goDown();\n    } else if (e.which == 38) {\n      this.goUp();\n    } else if (e.which == 13) {\n      this.hitEnter()\n    } else if (e.which == 27) {\n      this.hitEsc();\n    }\n  }\n\n  onInput(e) {\n    let val = e.currentTarget.value;\n    let matches = this.findMatches(val);\n\n    if (matches.length) {\n      this.dropdownMenu[0].innerHTML = this.renderDropdownHtml(matches);\n      this.openDropdown()\n    } else {\n      this.closeDropdown()\n    }\n  }\n\n  renderDropdownHtml(matches) {\n    let html = []\n\n    matches.forEach((t) => {\n      html.push(`\n        <a class='dropdown-item' data-id='${t.id}' href='#'>\n          ${t.friendlyName()}\n          <span class=\"badge badge-${t.badgeClass()}\">${t.type}</span>\n        </a>\n      `)\n    })\n\n    return html.join('')\n  }\n\n  findMatches(query) {\n    if (query.length > 2) {\n      query = new RegExp(query.replace(/\\s|\\(|\\)/, ''), \"i\")\n    } else {\n      query = new RegExp('^' + query.replace(/\\s|\\(|\\)/, ''), \"i\")\n    }\n\n    let matches = [];\n\n    ['countries', 'states', 'cities'].some((thing) => {\n      let things = window[thing];\n\n      return things.some((t) => {\n        if (query.test(t.terse)) {\n          matches.push(t)\n        }\n\n        return matches.length >= 20;\n      })\n    })\n\n    return matches;\n  }\n}\n\nexport default SearchView;\n","import Territory from '../models/territory.js';\n// import map from '../../node_modules/lodash/map.js';\n\nclass TerritoryView {\n  constructor() {\n    this.territoryDiv = $('#territory-hold');\n    this.territoryDiv.on('click', 'a.dropdown-item', this.clickTerritory.bind(this))\n  }\n\n  clickTerritory(e) {\n    e.preventDefault();\n\n    let t = $(e.currentTarget);\n    let id = t.closest('.dropdown').attr('data-id');\n    let territory = Territory.findById(id);\n\n    if (t.hasClass('reset')) {\n      window.mapView.resetTerritory(territory);\n    } else if (t.hasClass('goto')) {\n      window.mapView.gotoTerritory(territory);\n    } else if (t.hasClass('remove')) {\n      let dropdown = this.territoryDiv.find(`div.dropdown[data-id=\"${territory.id}\"]`);\n      dropdown.remove();\n\n      window.mapView.removeTerritory(territory);\n    }\n  }\n\n  addTerritory(t) {\n    let html = this.renderTerritory(t);\n    this.territoryDiv.append(html);\n  }\n\n  renderTerritory(t) {\n    return `\n      <div class=\"dropdown pl-2\" data-id='${t.id}'>\n        <button class=\"btn btn-outline-secondary dropdown-toggle\" type=\"button\" id=\"dropdownMenuButton\" data-toggle=\"dropdown\">\n          ${t.name}\n        </button>\n        <div class=\"dropdown-menu\">\n          <a class=\"dropdown-item reset\" href=\"#\">Reset</a>\n          <a class=\"dropdown-item goto\" href=\"#\">Go to</a>\n          <div class=\"dropdown-divider\"></div>\n          <a class=\"dropdown-item remove\" href=\"#\">Remove</a>\n        </div>\n      </div>`\n  }\n}\n\nexport default TerritoryView;\n"]}