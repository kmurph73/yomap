{"version":3,"sources":["app/initialize.js","app/map_util.js","app/models/territory.js","app/views/map_view.js","app/views/search_view.js","app/views/territory_view.js"],"names":["document","addEventListener","window","searchView","SearchView","territoryView","TerritoryView","mapView","MapView","gmapifyPoints","points","point","google","maps","LatLng","gmapifyPolygons","polygons","poly","c","gon","i","innerCoords","len","outerCoords","purgeLonePoints","coords","push","length","Territory","attrs","mappedPolygons","Object","assign","id","getId","type","abbrev","terse","join","name","state","toUpperCase","country","root","url","bounds","LatLngBounds","forEach","p","extend","getCenter","getURL","$","getJSON","success","resp","addTerritory","error","err","allTerritories","t","territories","removeTerritory","map","setCenter","zoom","setZoom","setMap","polygon","addPolygon","Polygon","paths","strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","draggable","geodesic","ele","dropdownMenu","find","input","on","onInput","bind","onKeydown","onFocus","clickDropdownItem","places","countries","filter","states","cities","click","event","target","closest","removeClass","classList","add","val","setTimeout","closeDropdown","findById","getAttribute","fetchPoints","e","addItem","currentTarget","addClass","value","openDropdown","dir","active","children","index","last","first","item","moveSelection","which","goDown","goUp","hitEnter","hitEsc","matches","findMatches","innerHTML","renderDropdownHtml","html","friendlyName","badgeClass","query","RegExp","replace","some","thing","things","test","territoryDiv","clickTerritory","preventDefault","attr","territory","hasClass","resetTerritory","gotoTerritory","dropdown","remove","renderTerritory","append"],"mappings":"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","file":"public/app.js","sourcesContent":["import Territory from 'models/territory.js';\nimport SearchView from 'views/search_view.js';\nimport TerritoryView from 'views/territory_view.js';\nimport MapView from 'views/map_view.js';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  // do your setup here\n  // console.log('Initialized app');\n\n  window.searchView = new SearchView;\n  window.territoryView = new TerritoryView;\n  window.mapView = new MapView;\n});\n","import reject from 'lodash/reject';\nimport map from 'lodash/map';\n\nvar gmapifyPoints = function(points) {\n  return map(points, function(point) {\n    return new google.maps.LatLng(point[1], point[0]);\n  });\n};\n\nexport const gmapifyPolygons = function(polygons) {\n  return map(polygons, function(poly) {\n    var c, gon, i, innerCoords, len, outerCoords;\n    gon = [];\n    outerCoords = gmapifyPoints(purgeLonePoints(poly.outerCoords));\n    innerCoords = map(poly.innerCoords, function(coords) {\n      return gmapifyPoints(purgeLonePoints(coords));\n    });\n    gon.push(outerCoords);\n    for (i = 0, len = innerCoords.length; i < len; i++) {\n      c = innerCoords[i];\n      gon.push(c);\n    }\n    return gon;\n  });\n};\n\nvar purgeLonePoints = function(coords) {\n  return reject(coords, function(point) {\n    return point.length < 2;\n  });\n};\n","import find from 'lodash/find';\n\nimport {gmapifyPolygons} from './../map_util.js';\n\nclass Territory {\n  constructor(attrs) {\n    this.polygons = [];\n    this.mappedPolygons = [];\n\n    Object.assign(this, attrs);\n    this.id = this.getId()\n  }\n\n  getId() {\n   return [this.type, this.abbrev || this.terse].join('-')\n  }\n\n  friendlyName() {\n    let name = this.name;\n\n    if (this.type == 'city') {\n      name = name + ` (${this.state.toUpperCase()})`\n    } else if (this.type == 'state') {\n      name = name + ` (${this.country.toUpperCase()})`\n    }\n\n    return name;\n  }\n\n  badgeClass() {\n    switch(this.type) {\n      case 'city': return 'info'\n      case 'state': return 'light'\n      case 'country': return 'dark'\n    }\n  }\n\n  static findById(id) {\n    return find(window.allTerritories, t => t.id == id)\n  }\n\n  getURL() {\n    const root = 'https://s3-us-west-2.amazonaws.com/yodap'\n    var url;\n\n    if (this.type == 'country') {\n      url = `${root}/countries/${this.abbrev}.json`\n    } else if (this.type == 'state') {\n      url = `${root}/states/${this.abbrev}.json`\n    } else if (this.type == 'city') {\n      url = `${root}/cities/${this.country}/${this.state}/${this.terse}.json`\n    }\n\n    return url;\n  }\n\n  getCenter() {\n    let bounds = new google.maps.LatLngBounds()\n    let polygons = this.polygons\n    let points = polygons[0][0]\n\n    points.forEach((p) => {\n      bounds.extend(p)\n    })\n\n    return bounds.getCenter()\n  }\n\n  fetchPoints() {\n    let url = this.getURL();\n\n    $.getJSON({\n      url: url,\n      success: (resp) => {\n        this.polygons = gmapifyPolygons(resp.polygons);\n        window.mapView.addTerritory(this);\n      },\n      error: (err) => {\n      }\n    });\n  }\n}\n\nexport default Territory;\n","class MapView {\n  constructor() {\n    this.territories = [];\n  }\n\n  resetTerritory(t) {\n    this.removeTerritory(t);\n    this.addTerritory(t);\n  }\n\n  gotoTerritory(t) {\n    window.map.setCenter(t.getCenter())\n\n    var zoom;\n    switch (t.type) {\n      case 'city':\n        zoom = 10;\n        break;\n      case 'state':\n        zoom = 5;\n        break;\n      case 'country':\n        zoom = 4;\n        break;\n    }\n\n    window.map.setZoom(zoom)\n  }\n\n  removeTerritory(t) {\n    t.mappedPolygons.forEach((p) => {\n      p.setMap(null)\n    })\n  }\n\n  addTerritory(t) {\n    t.polygons.forEach((coords) => {\n      let polygon = this.addPolygon(coords);\n      t.mappedPolygons.push(polygon);\n    })\n  }\n\n  addPolygon(coords) {\n    let polygon = new google.maps.Polygon({\n      map: window.map,\n      paths: coords,\n      strokeColor: \"#FF0000\",\n      strokeOpacity: 0.8,\n      strokeWeight: 1,\n      fillColor: \"#FF0000\",\n      fillOpacity: 0.35,\n      draggable: true,\n      geodesic: true\n    })\n\n    return polygon;\n  }\n}\n\nexport default MapView;\n","import Territory from '../models/territory.js';\nimport flatten from 'lodash/flatten';\n\n// import flatten from '../../node_modules/lodash/flatten.js';\n// import map from '../../node_modules/lodash/map.js';\n\nclass SearchView {\n  constructor() {\n    this.ele = $('#search-hold');\n    this.dropdownMenu = this.ele.find('.dropdown-menu');\n\n    let input = $('#search-input');\n    input.on('input', this.onInput.bind(this));\n    input.on('keydown', this.onKeydown.bind(this));\n    input.on('focus', this.onFocus.bind(this));\n    this.dropdownMenu.on('click', 'a.dropdown-item', this.clickDropdownItem.bind(this))\n\n    $.getJSON({\n      url: 'https://s3-us-west-2.amazonaws.com/yodap/places.json.gz',\n      success: function(places) {\n        window.countries = places.filter(p => p.type == 'country').map(p => new Territory(p));\n        window.states = places.filter(p => p.type == 'state').map(p => new Territory(p));\n        window.cities = places.filter(p => p.type == 'city').map(p => new Territory(p));\n        window.allTerritories = flatten([countries, states, cities]);\n      }.bind(this)\n    })\n\n    $(document).click((event) => {\n      if(!$(event.target).closest('#search-dropdown-hold').length) {\n        this.dropdownMenu.removeClass('show');\n      }\n    });\n  }\n\n  addItem(ele) {\n    ele.classList.add('active')\n    $('#search-input').val('')\n    setTimeout(() => this.closeDropdown(), 5)\n\n    let t = Territory.findById(ele.getAttribute('data-id'))\n    t.fetchPoints();\n    window.territoryView.addTerritory(t)\n  }\n\n  clickDropdownItem(e) {\n    this.dropdownMenu.find('a.active').removeClass('active')\n    this.addItem(e.currentTarget)\n  }\n\n  openDropdown() {\n    this.dropdownMenu.addClass('show')\n  }\n\n  closeDropdown() {\n    this.dropdownMenu.removeClass('show')\n  }\n\n  onFocus(e) {\n    if (e.currentTarget.value.length) {\n      this.openDropdown()\n    }\n  }\n\n  moveSelection(dir) {\n    let active = this.dropdownMenu.find('.active')[0];\n    let children = this.dropdownMenu.children();\n\n    let index = active ? children.index(active) : -1;\n\n    let ele = children[index + dir];\n\n    if (!ele) {\n      ele = dir == -1 ? children.last()[0] : children.first()[0]\n    }\n\n    children.removeClass('active')\n\n    if (ele) {\n      ele.classList.add('active')\n    }\n  }\n\n  hitEnter() {\n    let item;\n    if (item = this.dropdownMenu.find('.active')[0]) {\n      this.addItem(item);\n    }\n  }\n\n  hitEsc() {\n    this.closeDropdown()\n  }\n\n  goUp() { this.moveSelection(-1) }\n  goDown() { this.moveSelection(1) }\n\n  onKeydown(e) {\n    if (e.which == 40) {\n      this.goDown();\n    } else if (e.which == 38) {\n      this.goUp();\n    } else if (e.which == 13) {\n      this.hitEnter()\n    } else if (e.which == 27) {\n      this.hitEsc();\n    }\n  }\n\n  onInput(e) {\n    let val = e.currentTarget.value;\n    let matches = this.findMatches(val);\n\n    if (matches.length) {\n      this.dropdownMenu[0].innerHTML = this.renderDropdownHtml(matches);\n      this.openDropdown()\n    } else {\n      this.closeDropdown()\n    }\n  }\n\n  renderDropdownHtml(matches) {\n    let html = []\n\n    matches.forEach((t) => {\n      html.push(`\n        <a class='dropdown-item' data-id='${t.id}' href='#'>\n          ${t.friendlyName()}\n          <span class=\"badge badge-${t.badgeClass()}\">${t.type}</span>\n        </a>\n      `)\n    })\n\n    return html.join('')\n  }\n\n  findMatches(query) {\n    if (query.length > 2) {\n      query = new RegExp(query.replace(/\\s|\\(|\\)/, ''), \"i\")\n    } else {\n      query = new RegExp('^' + query.replace(/\\s|\\(|\\)/, ''), \"i\")\n    }\n\n    let matches = [];\n\n    ['countries', 'states', 'cities'].some((thing) => {\n      let things = window[thing];\n\n      return things.some((t) => {\n        if (query.test(t.terse)) {\n          matches.push(t)\n        }\n\n        return matches.length >= 20;\n      })\n    })\n\n    return matches;\n  }\n}\n\nexport default SearchView;\n","import Territory from '../models/territory.js';\n// import map from '../../node_modules/lodash/map.js';\n\nclass TerritoryView {\n  constructor() {\n    this.territoryDiv = $('#territory-hold');\n    this.territoryDiv.on('click', 'a.dropdown-item', this.clickTerritory.bind(this))\n  }\n\n  clickTerritory(e) {\n    e.preventDefault();\n\n    let t = $(e.currentTarget);\n    let id = t.closest('.dropdown').attr('data-id');\n    let territory = Territory.findById(id);\n\n    if (t.hasClass('reset')) {\n      window.mapView.resetTerritory(territory);\n    } else if (t.hasClass('goto')) {\n      window.mapView.gotoTerritory(territory);\n    } else if (t.hasClass('remove')) {\n      let dropdown = this.territoryDiv.find(`div.dropdown[data-id=\"${territory.id}\"]`);\n      dropdown.remove();\n\n      window.mapView.removeTerritory(territory);\n    }\n  }\n\n  addTerritory(t) {\n    let html = this.renderTerritory(t);\n    this.territoryDiv.append(html);\n  }\n\n  renderTerritory(t) {\n    return `\n      <div class=\"dropdown pl-2\" data-id='${t.id}'>\n        <button class=\"btn btn-outline-secondary dropdown-toggle\" type=\"button\" id=\"dropdownMenuButton\" data-toggle=\"dropdown\">\n          ${t.name}\n        </button>\n        <div class=\"dropdown-menu\">\n          <a class=\"dropdown-item reset\" href=\"#\">Reset</a>\n          <a class=\"dropdown-item goto\" href=\"#\">Go to</a>\n          <div class=\"dropdown-divider\"></div>\n          <a class=\"dropdown-item remove\" href=\"#\">Remove</a>\n        </div>\n      </div>`\n  }\n}\n\nexport default TerritoryView;\n"]}